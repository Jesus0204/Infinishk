<%- include('../includes/dropdown_admin.ejs') %>

<section class="section">
    <div class="container">
        <h2 class="title is-2">Alumnos atrasados en pagos</h2>
        <table class="table is-bordered is-hoverable is-fullwidth">
            <thead>
                <tr>
                    <th colspan="2">
                        <div class="columns">
                            <div class="column is-1">
                                2
                            </div>
                            <div class="column is-5">
                                Alumno: <%= deudas_atrasadas[0].Nombre %>
                                <%= deudas_atrasadas[0].Apellidos %>
                            </div>
                            <div class="column is-4">
                                Matricula: <%= deudas_atrasadas[0].matricula %>
                            </div>
                            <div class="column">
                                <form action="/plantilla_correo" method="POST">
                                    <button type="submit" class="button is-rounded">Enviar Correo</button>
                                </form>
                            </div>
                        </div>
                    </th>
                </tr>
            </thead>
            <tbody>
                <% let currentDate = new Date(); %>
                <% let options = { year: 'numeric', month: 'long', day: 'numeric' }; %>
                <% for (let count = 0; count < deudas_atrasadas.length; count = count + 2) { %>
                <% if (count + 1 == deudas_atrasadas.length) { %>
                <tr>
                    <td colspan="2">
                        <div class="columns">
                            <% if (deudas_atrasadas[count].pagado == 1) { %>
                            <div class="column is-2">
                                <i class="fa-solid fa-circle-check" style="color: #17b585;"></i>
                            </div>
                            <% } else if (currentDate < deudas_atrasadas[count].fechaLimitePago) { %>
                            <div class="column is-2">
                                <i class="fa-solid fa-clock" style="color: #ffc800;"></i>
                            </div>
                            <% } else {%>
                            <div class="column is-2">
                                <i class="fa-solid fa-circle-xmark" style="color: #910106;"></i>
                            </div>
                            <% } %>
                            <div class="column is-5">
                                Saldo Pendiente: <%= deudas_atrasadas[count].saldoPendiente %>
                                <br>
                                Monto A Pagar: <%= deudas_atrasadas[count].montoAPagar %>
                                Monto Pagado:<%= deudas_atrasadas[count].montoPagado %>
                            </div>
                            <div class="column is-5">
                                Fecha Limite Pago:
                                <%= deudas_atrasadas[count].fechaLimitePago.toLocaleDateString("es-MX", options) %>
                            </div>
                        </div>
                    </td>
                </tr>
                <% } else {%>
                <tr>
                    <td>
                        <div class="columns">
                            <% if (deudas_atrasadas[count].pagado == 1) { %>
                            <div class="column is-2">
                                <i class="fa-solid fa-circle-check" style="color: #17b585;"></i>
                            </div>
                            <% } else if (currentDate < deudas_atrasadas[count].fechaLimitePago) { %>
                            <div class="column is-2">
                                <i class="fa-solid fa-clock" style="color: #ffc800;"></i>
                            </div>
                            <% } else {%>
                            <div class="column is-2">
                                <i class="fa-solid fa-circle-xmark" style="color: #910106;"></i>
                            </div>
                            <% } %>
                            <div class="column is-5">
                                Saldo Pendiente: <%= deudas_atrasadas[count].saldoPendiente %>
                                <br>
                                Monto A Pagar: <%= deudas_atrasadas[count].montoAPagar %>
                                Monto Pagado:<%= deudas_atrasadas[count].montoPagado %>
                            </div>
                            <div class="column is-5">
                                Fecha Limite Pago:
                                <%= deudas_atrasadas[count].fechaLimitePago.toLocaleDateString("es-MX", options) %>
                            </div>
                        </div>
                    </td>
                    <td>
                        <div class="columns">
                            <% if (deudas_atrasadas[count + 1].pagado == 1) { %>
                            <div class="column is-2">
                                <i class="fa-solid fa-circle-check" style="color: #17b585;"></i>
                            </div>
                            <% } else if (currentDate < deudas_atrasadas[count + 1].fechaLimitePago) { %>
                            <div class="column is-2">
                                <i class="fa-solid fa-clock" style="color: #ffc800;"></i>
                            </div>
                            <% } else {%>
                            <div class="column is-2">
                                <i class="fa-solid fa-circle-xmark" style="color: #910106;"></i>
                            </div>
                            <% } %>
                            <div class="column is-5">
                                Saldo Pendiente: <%= deudas_atrasadas[count + 1].saldoPendiente %>
                                <br>
                                Monto A Pagar: <%= deudas_atrasadas[count + 1].montoAPagar %>
                                Monto Pagado:<%= deudas_atrasadas[count + 1].montoPagado %>
                            </div>
                            <div class="column is-5">
                                Fecha Limite Pago:
                                <%= deudas_atrasadas[count + 1].fechaLimitePago.toLocaleDateString("es-MX", options) %>
                            </div>
                        </div>
                    </td>
                </tr>
                <% } %>
                <% } %>
            </tbody>
        </table>
    </div>
    <button class="button">Button</button>
</section>